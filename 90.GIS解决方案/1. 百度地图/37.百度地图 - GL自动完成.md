- [百度地图（37）-GL 自动完成](https://www.cnblogs.com/googlegis/p/14707461.html)

1. 自动完成和二维功能类似，使用 BMapGL.Autocomplete 进行完成，  可以指定输入框的ID，以及对应的地图对象。

2. 有个问题：

 三维的情况下，必需将 searchResultPanel display 属性必需设为 block，设为none的时候，无法触发 onhighlight 和 onconfirm 事件。

3. 代码参考

```js
function addAutocomplete(){
  var ac = new BMapGL.Autocomplete(    //建立一个自动完成的对象
    {"input" : "suggestId",
      "location" : map
    });

  ac.addEventListener("onhighlight", function(e) {  //鼠标放在下拉列表上的事件
    var str = "";
    var _value = e.fromitem.value;
    var value = "";
    if (e.fromitem.index > -1) {
      value = _value.province +  _value.city +  _value.district +  _value.street +  _value.business;
    }
    str = "FromItem<br />index = " + e.fromitem.index + "<br />value = " + value;

    value = "";
    if (e.toitem.index > -1) {
      _value = e.toitem.value;
      value = _value.province +  _value.city +  _value.district +  _value.street +  _value.business;
    }
    str += "<br />ToItem<br />index = " + e.toitem.index + "<br />value = " + value;
    G("searchResultPanel").innerHTML = str;
  });

  var myValue;
  ac.addEventListener("onconfirm", function(e) {    //鼠标点击下拉列表后的事件
    var _value = e.item.value;
    myValue = _value.province +  _value.city +  _value.district +  _value.street +  _value.business;
    G("searchResultPanel").innerHTML ="onconfirm<br />index = " + e.item.index + "<br />myValue = " + myValue;

    setPlace();
  });

  function setPlace(){
    map.clearOverlays();    //清除地图上所有覆盖物
    function myFun(){
      var pp = local.getResults().getPoi(0).point;    //获取第一个智能搜索的结果
      alert(pp.lng);
      map.centerAndZoom(pp, 18);
      map.addOverlay(new BMapGL.Marker(pp));    //添加标注
    }
    var local = new BMapGL.LocalSearch(map, { //智能搜索
      onSearchComplete: myFun
    });
    local.search(myValue);
  }
}
```

4. 页面显示

![img](https://img2020.cnblogs.com/blog/59231/202104/59231-20210427091709511-1731118939.png)

 

![img](https://img2020.cnblogs.com/blog/59231/202104/59231-20210427091746101-1465921008.png)

5. 源码地址

https://github.com/WhatGIS/bdMap

